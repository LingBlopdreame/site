{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{617:function(a,s,e){\"use strict\";e.r(s);var t=e(13),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"jetso-nano-之-yolov4-部署\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jetso-nano-之-yolov4-部署\"}},[a._v(\"#\")]),a._v(\" Jetso Nano 之 Yolov4 部署\")]),a._v(\" \"),e(\"p\",[a._v(\"需要从头开始配置\"),e(\"RouterLink\",{attrs:{to:\"/post/jetson_nano/jetson-nano-zhe.html\"}},[a._v(\"点这里\")])],1),a._v(\" \"),e(\"h2\",{attrs:{id:\"_1-框架选择\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-框架选择\"}},[a._v(\"#\")]),a._v(\" 1. 框架选择\")]),a._v(\" \"),e(\"p\",[a._v(\"务必选择正确的框架，由于使用 jetson nano(armv8框架，使用 Jetpack 系统)，支持tkDNN框架：\")]),a._v(\" \"),e(\"p\",[a._v(\"https://github.com/ceccocats/tkDNN\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"_2-软件版本\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-软件版本\"}},[a._v(\"#\")]),a._v(\" 2. 软件版本\")]),a._v(\" \"),e(\"p\",[a._v(\"官方给出版本：\")]),a._v(\" \"),e(\"ul\",[e(\"li\",[a._v(\"CUDA 10.0\")]),a._v(\" \"),e(\"li\",[a._v(\"CUDNN 7.603\")]),a._v(\" \"),e(\"li\",[a._v(\"TENSORRT 6.01\")]),a._v(\" \"),e(\"li\",[a._v(\"OPENCV 3.4\")]),a._v(\" \"),e(\"li\",[a._v(\"yaml-cpp 0.5.2 (sudo apt install libyaml-cpp-dev)\")])]),a._v(\" \"),e(\"p\",[a._v(\"实际使用版本(经验证通过)：\")]),a._v(\" \"),e(\"ul\",[e(\"li\",[a._v(\"CUDA 10.2.89\")]),a._v(\" \"),e(\"li\",[a._v(\"CUDNN 8.0.0.180\")]),a._v(\" \"),e(\"li\",[a._v(\"TENSORRT 7.1.3.0\")]),a._v(\" \"),e(\"li\",[a._v(\"OPENCV 4.1.1\")]),a._v(\" \"),e(\"li\",[a._v(\"yaml-cpp 0.5.2 (sudo apt install libyaml-cpp-dev)\")])]),a._v(\" \"),e(\"p\",[a._v(\"该使用版本为 \"),e(\"code\",[a._v(\"jetpack\")]),a._v(\" 自带版本，版本可通过 \"),e(\"code\",[a._v(\"jtop\")]),a._v(\" 查看\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"_3-opencv版本选择\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-opencv版本选择\"}},[a._v(\"#\")]),a._v(\" 3. opencv版本选择\")]),a._v(\" \"),e(\"p\",[a._v(\"官方给出版本为\"),e(\"code\",[a._v(\"3.4\")]),a._v(\"，实际使用中可以应用\"),e(\"code\",[a._v(\"4.x\")]),a._v(\"版本，(目前 \"),e(\"code\",[a._v(\"jetpack\")]),a._v(\" 自带 \"),e(\"code\",[a._v(\"opencv4.x\")]),a._v(\" )，但要 \"),e(\"strong\",[a._v(\"注意\")]),a._v(\" 注释 \"),e(\"code\",[a._v(\"tkDNN/include/tkDNN/DetectionNN.h\")]),a._v(\" 中 \"),e(\"code\",[a._v(\"#define OPENCV_CUDACONTRIB\")])]),a._v(\" \"),e(\"h2\",{attrs:{id:\"_4-编译安装\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-编译安装\"}},[a._v(\"#\")]),a._v(\" 4. 编译安装\")]),a._v(\" \"),e(\"p\",[e(\"strong\",[a._v(\"注\")]),a._v(\" ：该编译过程需要用到 \"),e(\"code\",[a._v(\"cmake\")]),a._v(\" ，若使用 \"),e(\"code\",[a._v(\"opencv4.x\")]),a._v(\" ，需要最新版本 \"),e(\"code\",[a._v(\"cmake\")]),a._v(\" ，( \"),e(\"code\",[a._v(\"cmake > 3.15\")]),a._v(\" )\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[a._v(\"cd\")]),a._v(\" tkDNN\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"mkdir\")]),a._v(\" build\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[a._v(\"cd\")]),a._v(\" build\\n// cmake \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"..\")]),a._v(\" -DDEBUG\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"True          //if you want debug\\ncmake \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"..\")]),a._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"make\")]),a._v(\"\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"6\")]),e(\"br\")])]),e(\"h2\",{attrs:{id:\"_5-导入权重\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-导入权重\"}},[a._v(\"#\")]),a._v(\" 5. 导入权重\")]),a._v(\" \"),e(\"p\",[a._v(\"权重对于任何网络进行推理都是必不可少的。对于每个测试，需要一个按如下方式组织的文件夹（在build文件夹中）\")]),a._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(\"test_nn\\n        |---- layers/ (folder containing a binary file for each layer with the corresponding wieghts and bias)\\n        |---- debug/  (folder containing a binary file for each layer with the corresponding outputs)\\n\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"4\")]),e(\"br\")])]),e(\"p\",[a._v(\"(待续。。。。。)\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"_6-测试\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-测试\"}},[a._v(\"#\")]),a._v(\" 6. 测试\")]),a._v(\" \"),e(\"p\",[a._v(\"这是使用 \"),e(\"code\",[a._v(\"yolov4-tiny\")]),a._v(\" 的示例。\")]),a._v(\" \"),e(\"p\",[a._v(\"要运行对象检测，请首先通过运行以下命令创建 \"),e(\"code\",[a._v(\".rt\")]),a._v(\" 文件：\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"rm\")]),a._v(\" yolo4_fp32.rt        \"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"# be sure to delete(or move) old tensorRT files\")]),a._v(\"\\n./test_yolo4            \"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"# run the yolo test (is slow)\")]),a._v(\"\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\")])]),e(\"p\",[a._v(\"如果您在创建过程中遇到问题，请尝试通过以下方式检查激活TensorRT调试的错误：\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[a._v(\"cmake \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"..\")]),a._v(\" -DDEBUG\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"True\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"make\")]),a._v(\"\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\")])]),e(\"p\",[a._v(\"成功创建rt文件后，运行演示：\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[a._v(\"./demo yolo4_fp32.rt \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"..\")]),a._v(\"/demo/yolo_test.mp4 y\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\")])]),e(\"p\",[a._v(\"通常，演示程序采用6个参数：\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[a._v(\"./demo \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"network-rt-file\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"path-to-video\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"kind-of-network\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"number-of-classes\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"n-batches\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"show-flag\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\"\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\")])]),e(\"ul\",[e(\"li\",[e(\"code\",[a._v(\"<network-rt-file>\")]),a._v(\" 是测试生成的rt文件\")]),a._v(\" \"),e(\"li\",[e(\"code\",[a._v(\"<<path-to-video>\")]),a._v(\" 是视频文件或摄像机输入的路径\")]),a._v(\" \"),e(\"li\",[e(\"code\",[a._v(\"<kind-of-network>\")]),a._v(\"是网络的类型。当前支持这些类型：\"),e(\"code\",[a._v(\"y\")]),a._v(\"（YOLO系列），（CenterNet \"),e(\"code\",[a._v(\"c\")]),a._v(\"系列）和\"),e(\"code\",[a._v(\"m\")]),a._v(\"（MobileNet-SSD系列）\")]),a._v(\" \"),e(\"li\",[e(\"code\",[a._v(\"<number-of-classes>\")]),a._v(\"网络接受培训的课程数\")]),a._v(\" \"),e(\"li\",[e(\"code\",[a._v(\"<n-batches>\")]),a._v(\" 用于推理的批次数（注意，首先应将TKDNN_BATCHSIZE导出到所需的n_batches，然后再次为网络创建rt文件）。\")]),a._v(\" \"),e(\"li\",[e(\"code\",[a._v(\"<show-flag>\")]),a._v(\" 如果设置为0，则演示将不显示可视化效果，而是将视频保存到result.mp4中（如果n个批处理== 1）\")])]),a._v(\" \"),e(\"p\",[a._v(\"默认情况下用于FP32推理\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"_7-训练自己的数据集\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-训练自己的数据集\"}},[a._v(\"#\")]),a._v(\" 7. 训练自己的数据集\")]),a._v(\" \"),e(\"p\",[a._v(\"(待续。。。。)\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"错误锦集\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#错误锦集\"}},[a._v(\"#\")]),a._v(\" 错误锦集\")]),a._v(\" \"),e(\"h3\",{attrs:{id:\"_1-cmake-编译错误\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-cmake-编译错误\"}},[a._v(\"#\")]),a._v(\" 1. cmake 编译错误\")]),a._v(\" \"),e(\"p\",[a._v(\"请检查 \"),e(\"code\",[a._v(\"cmake\")]),a._v(\" 版本，\"),e(\"code\",[a._v(\"cmake >= 3.15\")])]),a._v(\" \"),e(\"p\",[a._v(\"如果 \"),e(\"code\",[a._v(\"opencv = 4.x\")]),a._v(\" ，请使用最新版\")]),a._v(\" \"),e(\"h3\",{attrs:{id:\"_2-make-错误\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-make-错误\"}},[a._v(\"#\")]),a._v(\" 2. make 错误\")]),a._v(\" \"),e(\"p\",[a._v(\"请检查对应版本，目前测试通过版本为\")]),a._v(\" \"),e(\"ul\",[e(\"li\",[a._v(\"CUDA 10.2\")]),a._v(\" \"),e(\"li\",[a._v(\"CUDNN 8.0.0\")]),a._v(\" \"),e(\"li\",[a._v(\"TENSORRT 7.1\")]),a._v(\" \"),e(\"li\",[a._v(\"OPENCV 4.1.1\")]),a._v(\" \"),e(\"li\",[a._v(\"yaml-cpp 0.5.2\")])]),a._v(\" \"),e(\"p\",[a._v(\"官方支持版本：\")]),a._v(\" \"),e(\"ul\",[e(\"li\",[a._v(\"CUDA 10.1\")]),a._v(\" \"),e(\"li\",[a._v(\"CUDNN 7.x\")]),a._v(\" \"),e(\"li\",[a._v(\"TENSORRT 6.x\")]),a._v(\" \"),e(\"li\",[a._v(\"OPENCV 4.1.1 ( 3.4.0 )\")]),a._v(\" \"),e(\"li\",[a._v(\"yaml-cpp 0.5.2 (sudo apt install libyaml-cpp-dev)\")])]),a._v(\" \"),e(\"p\",[e(\"strong\",[a._v(\"注：\")]),a._v(\" CUDA 和 CUDNN 版本要对应\")]),a._v(\" \"),e(\"h3\",{attrs:{id:\"_3-测试错误\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-测试错误\"}},[a._v(\"#\")]),a._v(\" 3. 测试错误\")]),a._v(\" \"),e(\"ul\",[e(\"li\",[a._v(\"如果出现下载慢或出错，请尝试其他渠道下载权重文件，并注释 \"),e(\"code\",[a._v(\"tkDNN/tests/darknet/yolo4tiny.cpp\")]),a._v(\" 中\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language-c++ line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(' downloadWeightsifDoNotExist(input_bins[0], bin_path, \"https://cloud.hipert.unimore.it/s/iRnc4pSqmx78gJs/download\");\\n')])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\")])]),e(\"ul\",[e(\"li\",[a._v(\"如果出现\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(\"could not parse line: \\n/home/lingblopdreame/jupyter/tkDNN/src/DarknetParser.cpp:246\\nAborting...\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\")])]),e(\"p\",[a._v(\"请修改 \"),e(\"code\",[a._v(\"tkDNN/src/DarknetParser.cpp:246\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language-c++ line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v('} else {\\n\\tcontinue;\\n\\tFatalError(\"could not parse line: \" + line);\\n}\\n')])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"4\")]),e(\"br\")])]),e(\"ul\",[e(\"li\",[a._v(\"如果出现\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(\"activation not supported: leaky\\n/home/lingblopdreame/jupyter/tkDNN/src/DarknetParser.cpp:180\\nAborting...\\n\")])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\")])]),e(\"p\",[a._v(\"请修改 \"),e(\"code\",[a._v(\"tkDNN/src/DarknetParser.cpp:177:178:179\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language-c++ line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v('if(f.activation != \"relu\") act = tkdnnActivationMode_t(CUDNN_ACTIVATION_RELU);\\n            else if(f.activation != \"leaky\") act = tk::dnn::ACTIVATION_LEAKY;\\n            else if(f.activation != \"mish\") act = tk::dnn::ACTIVATION_MISH;\\n')])]),a._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[a._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[a._v(\"3\")]),e(\"br\")])])])}),[],!1,null,null,null);s.default=n.exports}}]);","extractedComments":[]}